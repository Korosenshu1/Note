\documentclass[10pt, a4paper]{scrartcl}
% Packages
\usepackage[margin=1.25in]{geometry}
\usepackage{index}
\makeindex
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{tcolorbox}
\tcbuselibrary{theorems}
\tcbuselibrary{skins}
\tcbuselibrary{breakable}
\usepackage{varwidth}
\usepackage{amsmath, amssymb}
\usepackage{esint}
\usepackage{titlesec}
\usepackage{xcolor}
\usepackage{titling}
\usepackage[linktocpage]{hyperref}
\usepackage{pgfplots}
\usepackage{caption}
\usepackage{amsthm}
\usepackage{import}
\usepackage{cancel}
\usepackage{caption}
\usepackage{nicematrix}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage[italian]{babel}
\usepackage{setspace}
%\usepackage{cmupint}
\usepackage[perpage]{footmisc} % To reset footnote numbering each page
\setstretch{1.1}

% Titles 
\title{Note di Analisi 2}
\author{Manuel Deodato}
\date{}


% svolgimento
\newenvironment{svolgimento}{\renewcommand\qedsymbol{$\blacksquare$}\begin{proof}[Svolgimento]}{\end{proof}}


%%%%% tcolorbox setup

% Teorema e proposizione
\newtcbtheorem[number within=section]{teorema}{Teorema}
{breakable, top=0.2mm, bottom=0.2mm, boxrule=0mm,arc =.5 mm, colframe=blue!10, coltitle=black, fonttitle=\bfseries, colback=blue!5!white, theorem style=plain apart}{th}

\newtcbtheorem[number within=section]{prop}{Proposizione}
{breakable, top=0.2mm, bottom=0.2mm, boxrule=0mm,arc =.5 mm, colframe=blue!10, coltitle=black, fonttitle=\bfseries, colback=blue!5!white, theorem style=plain apart}{prop}





% Definizione
\definecolor{greendef}{HTML}{b8d8be}

\newtcbtheorem[number within=section]{definizione}{Definizione}
{breakable, top=0.2mm, bottom=0.2mm, boxrule=0mm, arc=.5mm, colframe=greendef, coltitle=black, fonttitle=\bfseries, theorem style = plain apart, colback=greendef!50!white}{def}


% Esempio
\theoremstyle{definition}
\newtheorem{esempio}{Esempio}

%\definecolor{empurple}{HTML}{6e5e89}

%\newtcbtheorem{esempio}{Esempio}{left=0mm,arc=0mm, colframe=empurple!10!white, coltitle=black, fonttitle=\bfseries, theorem style = plain, colback=empurple!20!white, colframe=empurple!90!white, boxrule=1pt, sharp corners, top=.2mm,bottom=.2mm}{es}

\tcolorboxenvironment{esempio}{blanker,breakable,left=5mm,before skip=10pt,after skip=10pt, borderline west={1mm}{0pt}{greendef}}

\numberwithin{esempio}{section}


% Lemma e Corollario
\definecolor{lemcor}{HTML}{a78d8a}

\newtcbtheorem[number within=section]{lemma}{Lemma}{breakable, top=0.2mm, bottom=0.2mm, boxrule=0mm,left=0mm,arc=.5mm, colframe=lemcor!10!white, coltitle=black, fonttitle=\bfseries, theorem style = plain apart, colframe=lemcor!50!white,colback=lemcor!20!white}{lem}
\newtcbtheorem[number within=section]{corollario}{Corollario}{breakable, top=0.2mm, bottom=0.2mm, boxrule=0mm,left=0mm,arc=.5mm, colframe=lemcor!10!white, coltitle=black, fonttitle=\bfseries, theorem style = plain apart, colframe=lemcor!50!white,colback=lemcor!20!white}{cor}



% Osservazione
\theoremstyle{definition}
\newtheorem{obs}{Osservazione}

\definecolor{coloros}{HTML}{6e5e89}

\tcolorboxenvironment{obs}{blanker,breakable,left=5mm,before skip=10pt,after skip=10pt, borderline west={1mm}{0pt}{coloros}}

\numberwithin{obs}{section}

% Nota
\newtheorem{nota}{Nota}

\definecolor{ncol}{HTML}{f9ebbe}

\tcolorboxenvironment{nota}{blanker,breakable,left=5mm,before skip=10pt,after skip=10pt, borderline west={1mm}{0pt}{ncol}}

\numberwithin{nota}{section}



%%%%%%%%%% Medie con integrali multipli
\def\Yint#1{\mathchoice
    {\YYint\displaystyle\textstyle{#1}}%
    {\YYint\textstyle\scriptstyle{#1}}%
    {\YYint\scriptstyle\scriptscriptstyle{#1}}%
    {\YYint\scriptscriptstyle\scriptscriptstyle{#1}}%
      \!\iint}
\def\YYint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\iint}$}
    \vcenter{\hbox{$#2#3$}}\kern-.51\wd0}}
\def\longdash{{-}\mkern-3.5mu{-}} 
   % consider using "\mkern-7.5mu" if esint package is loaded
\def\tiltlongdash{\rotatebox[origin=c]{15}{$\longdash$}}
\def\fiint{\Yint\tiltlongdash}

\def\Zint#1{\mathchoice
    {\YYint\displaystyle\textstyle{#1}}%
    {\YYint\textstyle\scriptstyle{#1}}%
    {\YYint\scriptstyle\scriptscriptstyle{#1}}%
    {\YYint\scriptscriptstyle\scriptscriptstyle{#1}}%
      \!\iiint}
      \def\tilongdash{\mkern6mu{-}\mkern-4mu{-}\mkern-5mu{-}} 
   % consider using "\mkern-7.5mu" if esint package is loaded
\def\titiltlongdash{\rotatebox[origin=c]{15}{$\tilongdash$}}
\def\fiiint{\Zint\titiltlongdash}

%Captions
\captionsetup[figure]{font=footnotesize,labelfont=footnotesize}
\captionsetup[table]{font=footnotesize,labelfont=footnotesize}
%Titlesec
\titleformat{\section}
{\fontsize{15}{20}\sffamily\scshape}
{\normalfont\color{gray}{\fontsize{20}{20}\selectfont\thesection}}
{0.7em}
{}
\hypersetup{colorlinks,breaklinks, linkcolor=[RGB]{74, 122, 164}}
\definecolor{asdf}{HTML}{4a7aa4}
% Personalizza la formattazione della subsection
\titleformat{\subsection}[block]{\fontsize{12}{20}\bfseries}{\normalfont\thesubsection}{.5em}{}


% Personalizza la formattazione della subsubsection
\titleformat{\subsubsection}[block]{\fontsize{10}{20}\bfseries}{\normalfont\thesubsubsection}{.5em}{}

% Maketitle customization
\renewcommand{\maketitle}{
\begin{center}
{\sffamily
{\fontsize{20}{20}\selectfont\MakeUppercase\thetitle}}

\vspace{0.2in}

{\large\scshape\sffamily\theauthor}
\end{center}
}

%Evaluate symbol
\DeclareMathOperator{\di}{d\!}
\newcommand*\Eval[3]{\left.#1\right\rvert_{#2}^{#3}}

%%%%%%% Numero delle equazioni in formato a.b
\numberwithin{equation}{subsection}
%%%%%

%%%%%%%%%% Personalizzazione numeri lista
\renewcommand{\theenumi}{(\arabic{enumi})}

%%%% Table of contents

\usepackage[titles]{tocloft}

\renewcommand{\cftdot}{}
\usepackage{titletoc}
%\setcounter{tocdepth}{2}

%%%%%%%%%%%%%%%% Toc style

% Personalizzazione scritta indice


% Font
%\usepackage[osf]{newpxtext}
%\usepackage{newpxmath}
\usepackage{sansiwona}

\begin{document}
\maketitle
\vspace{9cm}
\begin{figure}[h!]
	\centering
	\includegraphics[width=1\columnwidth]{front.png}
\end{figure}
\newpage
\tableofcontents 
\newpage
\section{Calcolo differenziale in pi\`u variabili}
\subsection{Derivate parziali}

Una funzione di pi\`u variabili $f(x,y):\mathbb{R}^2 \to \mathbb{R}$ pu\`o essere derivata mantenendo fissa una variabile e derivando rispetto all'altra. Questo corrisponde al valutare la variazione di $f$ lungo un asse specifico.
\begin{definizione}
	{Derivata parziale}{}
	Sia $f(x_1,\ldots,x_n) :\mathbb{R}^n \to \mathbb{R}$; la sua derivata parziale rispetto a $x_k$ \`e:
	\begin{equation}
		\frac{\partial f}{\partial x_k}(x_1,\ldots,x_n) = \lim_{h \to 0} \frac{f(x_1,\ldots,x_k + h, \ldots, x_n)-f(x_1,\ldots,x_k,\ldots,x_n)}{h}
	\end{equation}
\end{definizione}
\noindent Il vettore che ha per componenti le derivate di $f$ rispetto a ciascuna delle sue variabili si chiama \textbf{gradiente} e si indica con $\nabla f$.

\subsection{Derivate direzionali}

\`E possibile studiare la variazione di $f$ lungo una particolare direzione individuata dal versore $\hat{n}$. Una retta parallela a $\hat{n}$ e passante per un punto $x$ si individua con $x+t \hat{n}$; fissando i punti $x$ e $\hat{n}$, $g(t) := f(x+t\hat{n})$ \`e una funzione di una variabile e $g'(0)$ \`e la derivata direzionale di $f$ lungo $\hat{n}$:
\begin{equation}
	\frac{\partial f}{\partial \hat{n}} (x) = g'(0) = \lim_{h \to 0} \frac{f(x+h\hat{n}) - f(x)}{h}
\end{equation}
Pi\`u in generale:
\begin{equation}
	g'(t) \overset{\text{def}}{=} \lim_{h \to 0} \frac{g(t+h) - g(t)}{h} = \lim_{h \to 0} \frac{f(x_t+ h \hat{n}) - f(x_t)}{h} \equiv \frac{\partial f}{\partial \hat{n}} (x_t)
\end{equation}
con $x_t = x+t \hat{n}$. 
\begin{obs}
	Conoscendo $\nabla f$, si pu\`o calcolare la derivata direzionale di $f$ come $\nabla f \cdot \hat{n}$.
\end{obs}
\begin{esempio}
	Si calcola la derivata direzionale di $f(x,y) = x^2 y - e^{x+y} $ lungo la direzione $\hat{n} = \left(\frac{1}{2}, \frac{\sqrt{3} }{2}\right) $.
	\begin{svolgimento}
		Si ha 
		\[
		g(t) = f\left(x + \frac{t}{2}, y + \frac{\sqrt{3} }{2}t\right) = \left(x + \frac{t}{2}\right) ^2 \left(y + \frac{\sqrt{3} }{2}t\right) - \exp \left[ x + y + t\left(\frac{1}{2} + \frac{\sqrt{3} }{2}\right)  \right] 
		\] 
		Allora 
		\[
		\frac{\partial f}{\partial \hat{n}} (x,y) = g'(0) = xy + \frac{\sqrt{3} }{2}x^2 - \left(\frac{1}{2}+ \frac{\sqrt{3} }{2} \right) e^{x+y} 
		\] 
		Alternativamente $\nabla f = \left(2xy - e^{x+y} , x^2 - e^{x+y} \right) $, quindi $\partial _{\hat{n}} f = \nabla f \cdot \hat{n} =xy - \frac{1}{2} e^{x+y} +\frac{\sqrt{3} }{2} x^2 - \frac{\sqrt{3} }{2}e^{x+y} = xy + \frac{\sqrt{3} }{2}x^2 - \left(\frac{1}{2}+\frac{\sqrt{3} }{2}\right) e^{x+y}   $.
	\end{svolgimento}
\end{esempio}
\begin{teorema}
	{}{}
	Se $f:A\subset \mathbb{R}^2 \to  \mathbb{R}$ ha un massimo o minimo relativo in $x_0$ interno ad $A$ e se ammette derivata lungo $\hat{n}$ in $x_0$, allora:
	\begin{equation}
		\frac{\partial f}{\partial \hat{n}} (x_0)= 0 
	\end{equation}
	\begin{proof}
		Si prende $g(t) = f(x_0 + t \hat{n})$ che, per costruzione, ha un minimo in $t=0$, quindi $g'(0) = 0$, da cui segue la tesi.
	\end{proof}
\end{teorema}
\noindent In particolare, se $f$ \`e derivabile in $x_0$, tutte le derivate parziali si annullano in quel punto; in questo caso, $x_0$ \`e detto \textbf{punto stazionario}.

\begin{obs}
	Nel caso a una variabile, i punti di massimo/minimo che cadevano sulla frontiera di un insieme erano, solitamente, un numero finito; qua chiaramente non \`e pi\`u cos\`i.
\end{obs}
\begin{esempio}
	Calcolare massimi e minimi di $f(x,y) = (x^2 + y^2 - 1)e^{x+y} $ nel cerchio chiuso centrato nell'origine e di raggio $1$.
	\begin{svolgimento}
		Sul bordo del cerchio $x^2 + y^2 = 1$, quindi $f\equiv 0$. All'interno:
		\[
			\begin{split}
				&f_x = 2x e^{x+y}  + (x^2 + y^2 -1)e^{x+y} \\
				&f_y = 2y e^{x+y} + (x^2 + y^2 - 1) e^{x+y} 
			\end{split}
		\] 
	che si annullano quando 
	\[
	\begin{split}
		&x^2 + y^2 + 2x - 1 = 0\\
		&x^2 + y^2 + 2y - 1 = 0
	\end{split}\Rightarrow 2x - 2y = 0 \Rightarrow x=y
	\] 
Sostituendo $x=y$ nella prima equazione, ad esempio, si ottengono due soluzioni, una sola delle quali appartiene al cerchio; questo corrisponder\`a al punto di minimo della funzione:
\[
f\left(\frac{\sqrt{3} -1}{2}, \frac{\sqrt{3} -1}{2}\right) = (1-\sqrt{3} ) e^{\sqrt{3} -1}  < 0
\] 
\end{svolgimento}
\end{esempio}
\noindent In pi\`u dimensioni vale un analogo del teorema di Lagrange:
\begin{teorema}
	{}{}
	Sia $f(x) : A \subset \mathbb{R}^n \to \mathbb{R}$ e $x_0 \in A$, con $I(x_0,r) \subset A$. Considerando una direzione $\hat{n}$, si definisce $g(s) = f(x_0+ s \hat{n})$ per $\lvert s \rvert <r$. Vale l'analogo del teorema di Lagrange:
	\begin{equation}
		f(x_0+s\hat{n}) - f(x_0) = g(s) - g(0) = s g'(\tau ) = s \frac{\partial f}{\partial \hat{n}} (x_0 + \tau \hat{n})
	\end{equation}
\end{teorema}

\subsection{Derivate successive}

Sia $f$ una funzione per cui esistono le derivate prime e sono anch'esse derivabili; le derivate seconde potranno essere derivate prima rispetto a $x_i$ e poi rispetto a $x_j$ o viceversa. In generale se $f$ \`e una funzione di $m$, si hanno $m^n$ derivate di ordine $n$. Per le derivate seconde miste\footnote{Chiaramente il risultato vale in generale, ma si affronta per funzione di due variabili nel caso delle derivate seconde miste per semplicit\`a.} vale il seguente.
\begin{teorema}
	{Teorema di Schwarz}{}
	Sia $f$ una funzione derivabile in un intervallo $I$ del punto $(x,y)$ e siano queste continue nello stesso intervallo; allora $f_{xy} (x,y) = f_{yx} (x,y)$.
	\begin{proof}
		Siano $h,k \in \mathbb{R}:(x+h,y+k) \in I$ e sia
		\[
		A(h,k) = f(x+h,y+k) - f(x+h,y) - f(x,y+k) + f(x,y)
		\] 
		Prendendo $p(t) = f(t,y+k) - f(t,y)$, si ha $A(h,k) = p(x+h) - p(x)$; per Lagrange:
		\[
			A(h,k) = p'(\xi ) h = \big[f_x(\xi ,y+k) - f_x(\xi ,y)\big]h ,\ x< \xi <x+h
		\] 
		Applicando nuovamente Lagrange, si ha $A(h,k) = f_{yx} (\xi, \eta) hk, \ y<\eta < y+k$. Ripetendo il discorso con $q(t) = f(x+h,t) - f(x,t)$, si trova $A(h,k) = f_{xy} (\sigma ,\tau ) hk$, quindi $f_{yx}(\xi ,\eta) =f_{xy} (\sigma ,\tau ) $, dove $x<\sigma <x+h$ e $y<\tau <y+k$. Prendendo il limite per $h,k\to 0$, risulta $f_{xy} (x,y) = f_{yx} (x,y)$ per continuit\`a delle derivate seconde.
		
	\end{proof}
\end{teorema}
\noindent Come per funzioni di una variabile, vale la formula di Taylor.
\begin{teorema}
	{Formula di Taylor}{}
	Sia $f(x)$ di classe $C^2$ in $A \subset \mathbb{R}^n$ e $x_0$ punto interno ad $A$; in un intorno di $x_0$, allora, si ha:
	\begin{equation}
		f(x) = f(x_0) + \left\langle \nabla f(x_0), x-x_0 \right\rangle + \frac{1}{2} \left\langle Hf(x_0) (x-x_0), x-x_0 \right\rangle + R_2(x;x_0)
	\end{equation}
	con 
	\[
	\lim_{x \to x_0} \frac{R_2(x;x_0)}{\left\lVert x-x_0 \right\rVert ^2} = 0
	\] 
	
\end{teorema}

\subsection{Funzioni differenziabili}


Una funzione derivabile, anche in ogni direzione, non \`e necessariamente continua in pi\`u variabili.
\begin{esempio}
	La funzione $f(x,y) = \begin{cases}
		\frac{xy^2}{x^2 + y^2}& , \ (x,y)\neq 0\\
		0 & , \ (x,y) =0 
	\end{cases}$ ha derivate in ogni direzione nel punto $(0,0)$, ma non \`e continua; prendendo $x_k = (1 / k , 1/k^2)$ per $k\to \infty$, si ha $x_k\to (0,0)$, ma $f(x_k) = \frac{1/k^4}{2 / k^4} \to \frac{1}{2}$.
\end{esempio}

\begin{definizione}{Differenziabilit\`a}{}
	Una funzione $f(x)$ si dice differenziabile in $x_0$ se \`e derivabile in $x_0 $ e se:
	\begin{equation}
		\lim_{x \to x_0} \frac{f(x) - f(x_0) - \langle \nabla f(x_0) , x -x_0 \rangle}{\left\lVert x - x_0 \right\rVert } = 0
	\end{equation}
\end{definizione}
\noindent Questa definizione impone che una funzione sia differenziabile in punto se esiste un piano tangente che la approssima precisamente nel punto stesso.

\begin{teorema}
	{}{}
	Una funzione $f(x)$ differenziabile in $x_0$ \`e continua in $x_0$ ed \`e derivabile in ogni direzione.
	\begin{proof}
		Si mostra che \`e continua:
		\[
		f(x) - f(x_0)  = \frac{f(x) - f(x_0) - \langle \nabla f(x_0) , x-x_0 \rangle}{\left\lVert x-x_0 \right\rVert } \left\lVert x-x_0 \right\rVert + \langle \nabla f(x_0) , x-x_0 \rangle
		\] 
		Per $x\to x_0$ il primo termine di destra va a $0$ per assunzione di differenziabilit\`a e l'altro anche perch\'e diventa un prodotto scalare per $0$, quindi si verifica $\lim_{x \to x_0} f(x) = f(x_0)$.

		Data generica direzione $\hat{v}$ con $x = x_0 + t \hat{v}$, usando ancora definizione di differenziabilit\`a:
		\[
		\lim_{t \to 0} \frac{f(x_0 + t \hat{v})- f(x_0) - \langle \nabla f(x_0), t \hat{v} \rangle}{t} = 0 
		\] 
Visto che $\langle \nabla f(x_0 ) , t \hat{v} \rangle = t \langle \nabla f(x_0) ,\hat{v} \rangle$, si ottiene la tesi.
	\end{proof}
\end{teorema}
\noindent La direzione di massimo incremento di una funzione \`e quella del gradiente. Per mostrarlo, si parte da $x_0$, assumendo che non sia un punto stazionario; si definisce, allora, $\hat{n} = \frac{\nabla f(x_0)}{\left\lVert \nabla f(x_0) \right\rVert} $, da cui:
\[
\frac{\partial f}{\partial \hat{n}} (x_0) = \langle \nabla f(x_0), \hat{n} \rangle = \left\lVert \nabla f(x_0) \right\rVert 
\] 
Prendendo altra direzione generica $\hat{v}$, si ha:
\[
\frac{\partial f}{\partial \hat{v}} (x_0) = \langle \nabla f(x_0) , \hat{v}  \rangle \le  \left\lVert \nabla f(x_0) \right\rVert \left\lVert \hat{v} \right\rVert = \left\lVert \nabla f(x_0) \right\rVert \equiv \frac{\partial f}{\partial \hat{n}} (x_0)
\] 
Dalla definizione di funzione differenziabile il piano $z = f(x_0,y_0) +f_x(x_0,y_0) (x-x_0) + f_y(x_0,y_0) (y-y_0)$ \`e quello che meglio approssima la funzione in $(x_0,y_0)$.

Si \`e concluso che una funzione differenziabile \`e derivabile in ogni direzione, ma una funzione derivabile non \`e differenziabile in generale. Vale, per\`o, il seguente.
\begin{teorema}
	{Teorema del differenziale totale}{}
	Sia $f(x)$ derivabile in $x_0$ e siano le sue derivate continue nello stesso punto; allora $f$ \`e differenziabile in $x_0$.
	\begin{proof}
		Si vuole dimostrare che
		\[
		\lim_{(x,y) \to (x_0,y_0)} \frac{f(x,y) - f(x_0,y_0) - f_x(x_0,y_0) (x-x_0) - f_y(x_0,y_0)(y-y_0)}{\sqrt{(x-x_0)^2 + (y-y_0)^2} } = 0
		\] 
		Si usa il teorema di Lagrange per riscrivere $f(x,y) - f(x_0,y_0)$:
		\[
		\begin{split}
			&f(x,y_0) - f(x_0,y_0) = f_x(\xi ,y_0) (x-x_0),\ x_0<\xi <x\\
			&f(x,y) - f(x,y_0) = f_y(x ,\eta) (y-y_0), \ y_0 < \eta < y\\
			&\Rightarrow f(x,y) - f(x_0,y_0) = f_x(\xi ,y_0) (x-x_0) + f_y(x,\eta) (y-y_0)
		\end{split}
		\] 
	Il limite scritto sopra si riscrive come:
	\[
		\begin{split}
			\lim_{(x,y) \to (x_0,y_0)} \big[f_x(\xi ,y_0) - f_x(x_0,y_0)\big] &\frac{x-x_0}{\sqrt{(x-x_0)^2 + (y-y_0)^2} } + \\ 
											  &+\big[f_y(x,\eta) - f_y(x_0,y_0)\big] \frac{y-y_0}{\sqrt{(x-x_0)^2 + (y-y_0)^2} }
		\end{split}
	\] 
	Essendo le frazioni $\le 1$ e visto che le quantit\`a fra parentesi quadre, questo limite si maggiora con la somma delle parentesi quadre, che tende a $0$ per $(x,y) \to (x_0,y_0)$.
	\end{proof}
\end{teorema}
\subsection{Funzioni composte}
	Data una funzione $x(t) : \mathbb{R}^k \to \mathbb{R}^n$, si definisce, per una generica direzione $v$:
	\begin{equation}
		\frac{\partial x}{\partial v} = \left(\frac{\partial x_1}{\partial v}, \ldots , \frac{\partial x_n}{\partial t}  \right) ^\top
	\end{equation}
Vale il seguente per la derivata della funzione composta.
\begin{teorema}
	{}{}
	Siano $E \subset  \mathbb{R}^k , \ F \subset \mathbb{R}^n$ e $x(t) : E \to F , \ f(x) : F \to \mathbb{R}$ funzioni di classe $C^1$. Allora la funzione composta $g(t) = f(x(t)) : E \to\mathbb{R}$ \`e di classe $C^1$ e per ogni direzione $v$:
	\begin{equation}
		\frac{\partial g}{\partial v} (t) =\left\langle \nabla f\big(x(t)\big), \frac{\partial x}{\partial v} (t) \right\rangle
	\end{equation}
	\begin{proof}
		Si ha $g(t + h v) -g(t) = f\big(x(t+hv)\big) - f\big(x(t)\big) = f\big(x(t) + [x(t+hv) - x(t)]\big) - f\big(x(t)\big)$. Si prende $s = \lVert x(t+hv) - x(t) \rVert $ e la direzione$w = \frac{x(t+hv) - x(t)}{s}$ e si usa il teorema di Lagrange:
		\[
		g(t+hv) - g(t) = f\big(x(t) + s w\big) - f\big(x(t)\big) = s \frac{\partial f}{\partial w} \big(x(t) + \tau w\big) = s \left\langle \nabla f \big(x(t) + \tau  w\big), w \right\rangle
		\] 
	con $0<\tau <s$. Dividendo per $h$ e prendendo il limite $h\to 0$, per definizione $s \to 0$ e, quindi, $\tau  \to 0$, mentre $\frac{x(t+hv) - x(t)}{h}\to \frac{\partial x}{\partial v} (t)$ quindi:
\[
\lim_{h \to 0} \frac{g(t+ hv) -g(t)}{h} = \lim_{h \to 0} \left\langle \nabla f\big(x(t) + \tau  w\big), \frac{x(t+hv) - x(t)}{h} \right\rangle = \left\langle\nabla f\big(x(t)\big), \frac{\partial x}{\partial v} (t)  \right\rangle
\] 
	\end{proof}
\end{teorema}
\noindent Nel caso particolare $k=1$, $x(t)$ \`e una curva e $g(t)$ \`e funzione di una sola variabile con
\[
g'(t) = \sum_{h=1}^{n} \frac{\partial f}{\partial x_h} \big(x(t)\big) x'_h(t) \equiv \Big\langle \nabla f \big(x(t)\big), x'(t) \Big\rangle
\] 
Spesso si prende $x(t) = x + t v $, cio\`e retta passante per $x$ lungo direzione $v$; in questo caso $g'(t) = \nabla f(x+tv) \cdot  v$. Se le derivate seconde sono continue, le derivate prime sono differenziabili e si pu\`o scrivere:
\begin{equation}
	g''(t)	= \sum_{i=1}^{n} v_i \frac{d }{d t} D_i f (x+tv) = \sum_{i=1}^{n} v_i \sum_{j=1}^{n} v_j D_{ij} f(x+tv)
\end{equation}
Indicando con $Hf = \nabla f \nabla ^\top$ la matrice Hessiana di $f$, allora $\sum_{j}^{} v_j D_{ij} f(x+tv) \equiv \left[ Hf(x+tv) v\right]_i $, cio\`e \`e la componente $i$-esima del vettore tra parentesi quadre, essendo $Hf$ una matrice. Allora:
\begin{equation}
	\begin{split}
		&g'(0) = \nabla f(x) \cdot v \\ 
		& g''(0) = \langle Hf(x) v , v \rangle
	\end{split}
\end{equation}
 
\subsection{Massimi e minimi relativi}

Perch\'e una funzione $f$ di pi\`u variabili abbia un punto di massimo o di minimo in $x_0$, \`e condizione necessaria che per ogni direzione $v$, valga $g'(0) = 0$ e $g''(0) \le 0$ o $g''(0) \ge 0$, cio\`e:
\begin{equation}
	\begin{split}
		&\langle Hf (x_0) v , v \rangle \le 0 \text{ punto di massimo}\\
		&\langle Hf (x_0) v , v \rangle \ge 0 \text{ punto di minimo}
	\end{split}
\end{equation}
Allora vale il seguente.
\begin{teorema}
	{}{}
	Sia $f(x)$ una funzione con derivate seconde continue; se in $x_0$, $\nabla f (x_0) = 0$ e la matrice Hessiana \`e tale che $Hf(x_0) > 0$ (definita positiva), allora $x_0$ \`e di minimo relativo per $f$. Se fosse $Hf(x_0) < 0$, $x_0$ sarebbe di massimo relativo.
\end{teorema}
\noindent Possono verificarsi altri due casi:
\begin{itemize}
	\item se $\langle H f(x_0)v ,v \rangle $ assume sia valori positivi che negativi al variare di $v$, si ha un \textbf{punto di sella};
	\item se la matrice Hessiana \`e semidefinita, ma non definita, non si pu\`o concludere niente e bisogna esaminare cosa accade attorno a $x_0$.
\end{itemize}

\newpage 

\section{Calcolo integrale in pi\`u variabili}

\subsection{Integrazione in dimensioni superiori}
Per le definizioni di base, si deve definire cos'\`e un rettangolo.
\begin{definizione}
	{}{}
	Dati due intervalli $[a.b)$ e $[c,d)$, il rettangolo che identificano \`e definito come $R = [a,b) \times  [c,d)$, con $a\le x< b$ e $c\le y<d$.
\end{definizione}
\noindent Si suddividono due intervalli in intervalli pi\`u piccoli, cio\`e $[a,b)$ si suddivide in $n$ sotto-intervalli $I_h = [x_{h-1} ,x_h)$, con $x_0 =a , \ldots x_n = b$ e $[c,d)$ in $m$ sotto-intervalli $J_k = [y_{k-1} ,y_k)$. Allora il rettangolo sar\`a suddiviso in $n\times m$ sotto-rettangoli $R_{hk}  = I_h \times J_k$.

Una funzione semplice $\varphi (x)$ \`e una funzione che assume un valore costante su ogni sotto-rettangolo e che vale $0$ fuori da $R$. Indicando con $\lambda _{hk}$ il valore costante che assume in $R_{hk} $:
\begin{equation}
	\varphi (x)= \sum_{h=1}^{n} \sum_{k=1}^{m} \lambda _{hk} \chi _{R_{hk} } (x)
\end{equation}
con $\chi _D$ funzione caratteristica del dominio $D$. L'integrale di funzioni simili \`e dato da:
\begin{equation}
	\int \varphi (x) \ dxdy = \sum_{h=1}^{n} \sum_{k=1}^{m} \lambda _{hk} m(R_{hk} )= \sum_{h=1}^{n} \sum_{k=1}^{m} \lambda _{hk} m(I_h) m(J_k) = \sum_{h=1}^{n} \sum_{k=1}^{m} \lambda _{hk} (x_h -x_{h-1} ) (y_k - y_{k-1} )
\end{equation}
\`E necessario dare anche la definizione di supporto di una funzione:
\begin{definizione}
	{}{}
	Il supporto di una funzione $f$ \`e la chiusura dell'insieme in cui $f\neq 0$, cio\`e:
	\begin{equation}
		\operatorname{supp} (f) = \overline{\left\{ x : f(x) \neq 0 \right\} }
	\end{equation}
\end{definizione}
\noindent Infine, si indica con $\mathscr{S}^+(D)$ la classe delle funzioni semplici $\varphi $ che maggiorano $f$ in $D$ e $\mathscr{S}^-(D)$ la classe delle funzioni semplici $\psi $ che minorano $f$ in $D$; da questo, si ha la seguente definizione di integrale di Riemann.
\begin{definizione}
	{Integrazione di funzioni a supporto compatto}{}
	Sia $f$ una funzione a supporto compatto, con $\operatorname{supp} (f) \subset K$; $f$ \`e integrabile secondo Riemann se:
	\begin{equation}
		\sup_{\psi \in \mathscr{S}^-(K)}  \int \psi  \ dx dy = \inf_{\varphi \in \mathscr{S}^+(K)}  \int \varphi \ dxdy
	\end{equation}
	dove
	\begin{equation}
		\begin{split}
			&\int_{*} f(x) \ dx =  \inf_{\varphi \in \mathscr{S}^+(K)}  \int \varphi \ dxdy \ \text{ integrale inferiore} \\
			&\int^{*} f(x) \ dx =  \sup_{\psi  \in \mathscr{S}^-(K)}  \int \psi  \ dxdy \ \text{ integrale superiore} \\
		\end{split}
	\end{equation}
	La condizione di integrabilit\`a si pu\`o esprimere come:
	\begin{equation}
		\int_{*} f(x) \ dx= \int^{*} f(x) \ dx
	\end{equation}
\end{definizione}
\begin{obs}
	Anche per pi\`u variabili, \`e condizione sufficiente e necessaria perch\'e $f$ a supporto compatto sia integrabile che $\forall \varepsilon >0$, esistono funzioni semplici $\varphi ,\psi $ tali che:
	\begin{equation}
		\int \varphi  \ dxdy - \int \psi  \ dxdy < \varepsilon 
	\end{equation}
\end{obs}
\subsection{Misura di insiemi}
L'integrabilit\`a di una funzione su un certo insieme $E$ \`e legata alla misura dell'insieme stesso.
\begin{definizione}
	{Misurabilit\`a di insiemi}{}
	Un insieme $E$ \`e \textit{misurabile} (secondo Peano-Jordan) se la sua funzione caratteristica $\varphi _E$ \`e integrabile. In questo caso, la misura \`e:
	\begin{equation*}
		m(E) = \int \varphi _E \ d\mathbf{x} 
	\end{equation*}
\end{definizione}
\noindent Se $\varphi _E$ \`e integrabile, allora $\forall \varepsilon >0$, si avrebbero $\psi ,\varphi $ funzioni semplici con $\psi \le  \varphi _E \le \varphi $ tali che:
\[
\int \varphi  \ d\mathbf{x}  - \int \psi \ d\mathbf{x} < \varepsilon 
\] 
L'idea \`e suddividere il piano $x,y$ in rettangoli $R_{hk} $ dove $\varphi =1$ nei rettangoli $R_{hk} $ che hanno punti in comune con $E$ ed \`e nulla negli altri, mentre si prende $\psi =1 $ nei rettangoli contenuti in $E$ e pari a $0$ negli altri. Cos\`i facendo, l'integrale di $\varphi $ \`e la somma delle misure dei rettangoli $R_{hk}$ che hanno punti in comune con $E$, mentre quello di $\psi $ \`e la somma delle misure degli $R_{hk} $ contenuti in $E$. Il risultato della differenza \`e la somma delle misure dei rettangoli che hanno punti in comune con $E$, ma che non vi sono contenuti, quindi sar\`a la somma delle misure dei rettangoli che hanno punti in comune con la frontiera di $E$.

Si definisce \textbf{plurirettangolo} l'unione $P$ di un numero finito di rettangoli senza punti comuni, la cui misura coincide con la somma delle misure dei rettangoli che lo compongono; si ha la seguente.
\begin{prop}
	{}{mis21}
	Un insieme $E$ \`e misurabile $\iff \forall \varepsilon >0, \ \exists $ un plurirettangolo $P$ contenuto in $E$ e un plurirettangolo $Q$ che contiene $E$ tali che $m(Q) - m(E) < \varepsilon $.
\end{prop}
\noindent Usando Prop \ref{prop:mis21}, se $P,Q$ plurirettangoli t.c. $P \subset E \subset Q$, con $m(Q-P) = m(Q) - m(P)$, si ha che:
\begin{center}
	\textit{Un insieme $E$ \`e misurabile $\iff \forall \varepsilon > 0$ esiste $Z$ plurirettangolo che contiene $\partial E$, con $m(Z)<\varepsilon $.} 
\end{center}
Quindi:
\begin{center}
	\textit{Un insieme $E$ \`e misurabile (secondo Peano-Jordan) $\iff$ la sua frontiera\newline $\partial E$ ha misura nulla.} 
\end{center}
\begin{prop}
	{}{}
	Se due insiemi $A,B$ sono misurabili, allora sono misurabili anche $A \cup B , \ A \cap B $ e $A \setminus B$.
	\begin{proof}
		$A,B$ misurabili $\implies$ $\partial A, \ \partial B$ sono contenute in plurirettangoli $Z_A,Z_B$ che hanno misura minore di $\varepsilon , \ \forall \varepsilon >0$, quindi $m(Z_A \cup Z_B) < 2 \varepsilon $. Questo vuol dire che $m(\partial A \cup \partial B) = 0$, quindi le frontiere di $A\cup B , \ A \cap B $ e $A \setminus B$ hanno misura nulla.
	\end{proof}
\end{prop}
\subsubsection{Insiemi generati da funzioni}
Siano $g(x):\left[ a,b \right] \subset \mathbb{R} \to \mathbb{R}^{\ge 0}  $  e $G:= \left\{ (x,y) \in \mathbb{R}^2 : a\le x\le b , \ 0 \le  y \le  g(x) \right\}$. Se $g$ \`e integrabile, l'insieme $G$ \`e misurabile, con 
\begin{equation}
	m(G) = \int_{a} ^b g(x) \ dx
\end{equation}
\begin{proof}
	Essendo $g$ integrabile, $\forall \varepsilon >0$, esistono $\varphi ,\psi $ con $\int (\varphi -\psi ) \ dx < \varepsilon  $. Considerando i plurirettangoli 
	\[
		\Phi := \left\{ (x,y) \in \mathbb{R}^2 : a\le x\le b , \ 0\le  y \le \varphi (x) \right\} \hspace{.1cm} , \hspace{.2cm} \Psi := \left\{ (x,y) \in \mathbb{R}^2 : a\le x\le b , \ 0\le  y \le \psi (x) \right\}
	\] 
	per i quali
	\[
		m(\Phi) = \int \varphi  \ dx \hspace{.1cm} , \hspace{.2cm} m(\Psi) = \int \psi  \ dx 
	\] 
	si ha $\Psi \subset G \subset \Phi$ con $m(\Phi) - m(\Psi) < \varepsilon \Rightarrow G$ misurabile. 
	Inoltre, per quanto detto, sia $m(G)$ che $\int g \ dx$ sono contenuti tra $m(\Phi)$ e $m(\Psi)$, cio\`e:
	\[
	\left\lvert m(G) - \int_{a} ^b g(x) \ dx \right\rvert < m(\Phi) - m(\Psi)  < \varepsilon , \ \forall \varepsilon \implies m(G) = \int_{a} ^b g(x) \ dx
	\] 
	
\end{proof}
Siano, ora, $g,h$ due funzioni integrabili in $[a,b)$ con $0\le g(x) \le  h(x)$. L'insieme $E:=\left\{ (x,t) \in \mathbb{R}^2 : a\le x\le b, \ g(x) \le y \le h(x) \right\} $ \`e misurabile per quanto detto sopra, essendo $E$ dato dalla differenza degli insiemi $H,G$ definiti come sopra e misurabili a loro volta. Inoltre, sempre applicando quanto detto sopra alla differenza di $H,G$:
\[
m(E) = \int_{a} ^b \left[ h(x) - g(x) \right] \ dx 
\] 
\begin{obs}
	Questo \`e valido anche per $g,h$ non-positive; \`e, infatti, sufficiente applicare il ragionamento alle funzioni $h+c, \ g+c$, con $c$ preso in modo che siano entrambe positive e osservando che $E_c$ corrisponde a $E$ traslato di $c$ verso l'alto.
\end{obs}
\subsection{Integrabilit\`a di funzioni continue}
\begin{teorema}
	{}{}
	Sia $f(\mathbf{x} )$ continua in rettangolo chiuso $R$ e sia $E$ un insieme misurabile con $E \subset R$. Allora $f$ \`e integrabile in $E$.
	\begin{proof}
	Si mostra che $f \varphi _E$ \`e integrabile. 
	Per Weierstrass, $f$ \`e uniformemente continua in $R$, quindi $\forall \varepsilon >0, \ \exists \delta (\varepsilon )>0$ t.c. la divisione di $R$ in rettangoli $R_{hk} $ di diametro minore di $\delta (\varepsilon )$, risulta:
	\[
	M_{hk } - m_{hk}  = \sup_{R_{hk} } f - \inf_{R_{hk} } f < \varepsilon 
	\] 
Inoltre, $f$ ha massimo e minimo in $R$, indicati, rispettivamente, con $M$ e $m$. 
Allo stesso tempo, $E$ \`e misurabile, quindi $\forall \varepsilon >0, \ \exists $ suddivisione di $R$ in $R_{hk} $, assunta di diametro inferiore di $\delta (\varepsilon )$, tale che la misura dei rettangoli che hanno almeno un punto in comune con $\partial E$ \`e minore di $\varepsilon $.

Con questa suddivisione, si classificano con $\mathcal{I}, \mathcal{E}, \mathcal{F}$ rispettivamente i rettangoli interni, esterni e a contatto con la frontiera di $E$. Per la misurabilit\`a di $E$:
\[
\sum_{R_{jk} \in \mathcal{F}}^{} m(R_{hk} ) < \varepsilon 
\] 
Si definiscono:
\begin{itemize}
	\item funzione maggiorante $\varphi  $ che \`e nulla nei rettangoli esterni, $\phi = \max\left\{ M,0 \right\} $ in quelli di frontiera e $\phi = M_{hk} $ in quell interni.
	\item funzione minorante $\psi $ che \`e nulla in quelli esterni, $\psi = \min\left\{ m , 0 \right\} $ in quelli di frontiera e $\psi  = m_{hk} $ in quelli interni.
\end{itemize}
Quindi $\psi \le f\varphi  _E \le \varphi $ e
\[
\begin{split}
	\int (\varphi-\psi )  \ dx dy&= \big(\max \left\{ M,0 \right\} - \min \left\{ m,0 \right\} \big) \sum_{R_{hk} \in \mathcal{F}}^{} m(R_{hk}) + \sum_{R_{hk} \in \mathcal{I}}^{} (M_{hk} -m_{hk} ) m(R_{hk}) \\
						   &< \left(\lvert M \rvert +\lvert m \rvert \right) \varepsilon  + \varepsilon \sum_{R_{hk} \in \mathcal{I}}^{} m(R_{hk} ) < \varepsilon \big(\lvert M \rvert +\lvert m \rvert +m(R)\big) 
\end{split}
\] 
Allora $f$ \`e integrabile su $E$.
\end{proof}
\end{teorema}
\noindent Pi\`u in generale, vale il seguente.
\begin{teorema}
	{}{}
	Sia $f$ limitata in un rettangolo $R$. Questa \`e integrabile in $E\subset R$ se l'insieme $D$ dei suoi punti di discontintui\`a ha misura nulla.
	\begin{proof}
		Si ripete la dimostrazione precedente con $D$ al posto di $\partial E$.
	\end{proof}
\end{teorema}
\subsection{Integrali doppi}
Si analizza prima caso per funzioni semplici. 
Si considera suddivisione del rettangolo $R=I\times J$ in rettangoli $R_{hk} = I_h \times J_k$.
Sia $\varphi = \sum_{}^{} \lambda _{hk}\varphi _{R_{hk} } $ funzione semplice; fissando $x \in I_h$, si considera $\varphi $ come funzione della sola $y$ e:
\[
\int \phi (x,y) \ dy = \sum_{k}^{} \lambda _{hk} m(J_k)
\]
L'integrale a primo membro \`e costante per $x \in I_h$, pertanto \`e a sua volta una funzione semplice; integrandolo rispetto a $x$:
\[
\int dx \int \phi (x,y) \ dy = \sum_{h}^{} m(I_h) \sum_{k}^{} \lambda _{hk} m(J_k)= \sum_{h,k}^{} \lambda _{hk} m(I_h)m(J_k) = \sum_{h,k}^{} \lambda _{hk} m(R_{hk} )= \int\varphi  \ dxdy
\] 
Il discorso \`e analogo integrando prima rispetto a $x$ e poi rispetto a $y$. 
Si generalizza con il seguente.
\begin{teorema}
	{Teorema di Fubini}{}
	Sia $f(x,y)$ integrabile in $R = [a,b) \times [c,d)$ e sia questa integrabile $\forall x \in [a,b)$ rispetto alla variabile $y \in [c,d)$. 
	Allora la funzione $F(x) = \int_{c} ^d f(x,y) \ dy$ \`e integrabile in $[a,b)$ e 

	\[
	\int_{R} f(x,y) \ dxdy = \int_{a} ^b F(x) \ dx = \int_{a} ^b dx \int_{c} ^d f(x,y) \ dy
	\] 
\begin{proof}
	Visto che $f$ \`e integrabile in $R$, allora esistono $\psi , \varphi $ funzioni semplici t.c.
	\[
	\psi \le f \varphi _R \le \varphi, \text{ con }   \int (\varphi -\psi ) \ dxdy < \varepsilon 
	\] 
	Integrando le disuguaglianze rispetto alla $y$, si ottiene:
	\begin{equation}\label{ftheq1}
	\Psi(x) = \int_c^d \psi \ dy \le F(x) = \int_{c} ^d f\ dy \le \int_{c} ^d \varphi \ dy = \Phi(x)
	\end{equation}
	Le funzioni $\Phi,\Psi$ sono ancora funzioni semplici, rispettivamente maggiorante e minorante di $F$, per le quali vale
	\[
	\int_{a} ^b (\Phi-\Psi) \ dx = \int (\varphi -\psi ) \ dxdy < \varepsilon 
	\] 
	Quindi $F(x)$ \`e integrabile in $[a,b)$.
	Ora, integrando in $[a,b)$ l'eq. \ref{ftheq1}, si ha:
	\[
	\int_{R} \psi  \ dxdy \le \int_{a} ^b F(x) \ dx \le  \int_{R} \varphi (x,y) \ dxdy
	\] 
	Allo stesso tempo, integrando la disuguaglianza iniziale su $R$:
	\[
	\int_{R} \psi  \ dxdy \le \int_{R} f \ dxdy \le \int_R \varphi  \ dxdy
	\] 
	Unendo le due disuguaglianze:
\[
\left\lvert \int_{R} f(x,y)\ dxdy - \int_{a} ^b F(x) \ dx \right\rvert \le \int_{R} (\varphi -\psi ) \ dxdy < \varepsilon
\] 
Valendo $\forall \varepsilon >0$, si ottiene la tesi.
\end{proof}	
\end{teorema}
\noindent Questo teorema si applica anche a integrali su \textit{insiemi normali rispetto all'asse} $y$\footnote{Insiemi, la cui intersezione con la retta verticale $x=\text{cost.}$ \`e un segmento o un punto.}
\[
E := \left\{ (x,y) \in \mathbb{R}^2 : a\le x\le b , \ g(x) \le  y \le h(x) \right\} 
\] 
con $g,h$ continue in $[a,b]$. Per quanto visto, $E$ \`e misurabile e, se $f$ \`e continua su $E$, \`e anche integrabile in $E$ stesso. 
In generale, la funzione $f^* = f \varphi _E$ \`e integrabile in ogni rettangolo $R = [a,b] \times  [c,d] \supset E$.

Fissata $x \in [a,b)$, la funzione $f^*(x,y)$ vale $f(x,y)$ se $g(x) \le  y \le h(x)$ e $0$ altrimenti, quindi \`e continua tranne, al pi\`u, nei punti $g(x), h(x)$. Allora $f^*$ \`e integrabile e si pu\`o applicare Fubini:
\[
	\int_{R} f^*(x,y) \ dxdy = \int_{a} ^b dx \int_{c} ^d f^*(x,y) \ dy \implies \int_{E} f \ dxdy = \int_{a} ^b dx \int_{g(x)} ^{h(x)} f \ dy
\] 
\begin{esempio}
Calcolare
\[
\int_{E} x^2 y \ dxdy, \ E := \left\{ (x,y) \in \mathbb{R}^2:-1\le x\le 1 , \ 0 \le  y \le  \sqrt{1-x^2}  \right\} 
\] 
con $E$ semicirconferenza di raggio $1$ e centro l'origine.
\begin{svolgimento}
	L'insieme \`e normale rispetto all'asse $y$ e, per Fubini:
	\[
	\begin{split}
		\int_E x^2  y \ dxdy &= \int_{-1} ^{+1} dx \int_{0} ^{\sqrt{1-x^2} } x^2 y \ dy = \frac{1}{2}\int_{-1} ^{+1} \left[ x^2 y^2 \right] _{0} ^{\sqrt{1-x^2} }  dx\\
				     &= \frac{1}{2}\int_{-1} ^{+1} x ^2 (1-x^2) \ dx = \Eval{\left(\frac{x^3}{6}- \frac{x^5}{10}\right) }{-1}{+1} = \frac{2}{15}
	\end{split}
	\] 
	
\end{svolgimento}
\end{esempio}
\subsection{Integrali tripli}
Il teorema di Fubini si applica anche nel caso di tre o pi\`u variabili: se $f(x,y,z)$ \`e integrabile nel parallelepipedo $P = [a,b) \times [c,d) \times [r,s)$ e, $\forall (x,y) \in R = [a,b) \times [c,d)$, \`e integrabile rispetto a $z$, allora:
\[
\int_{P} f(x,y,z) \ dxdydz = \int_{R} dxdy \int_{r} ^s f(x,y,z) \ dz
\] 
In particolare, se $f$ \`e continua in $E$ insieme normale rispetto a $z$, cio\`e della forma $E:= \left\{ (x,y,z) \in \mathbb{R}^3 : (x,y) \in R, \ g(x,y)\le z \le h(x,y) \right\} $, si ha:
\begin{equation}\label{volintfub}
	\int_{E} f(x,y,z) \ dxdydz = \int_{R} dxdy \int_{g(x,y)} ^{h(x,y)} f(x,y,z) \ dz
\end{equation}
Ovviamente il ragionamento si pu\`o poi applicare quando si dovr\`a calcolare l'integrale doppio.
\begin{esempio}
Per $E:=\left\{ (x,y,z) \in \mathbb{R}^3 : x>0,y>0,z>0, \ x+y+z < 2\right\} $, calcolare
\[
\int_{E} (x+y-z) \ dxdydz
\] 
\begin{svolgimento}
	L'insieme \`e normale rispetto a $z$, quindi:
	\[
	\int_{E} (x+y-z) \ dxdydz = \int_{T} dxdy \int_{0} ^{2-x-y}  (x+y-z) \ dz
	\] 
	con $T:= \left\{ (x,y) \in \mathbb{R}^2:x>0,y>0, \ x+y <2 \right\} = \left\{ (x,y) \in \mathbb{R}^2 : 0<x<2, \ 0<y<2-x \right\}  $. 
	L'ultimo integrale \`e:
	\[
	\int_{0} ^{2-x-y} (x+y-z) \ dz = \left[ xz + yz - \frac{z^2}{2} \right] _{0} ^{2-x-y}  = 4(x+y) - \frac{3}{2}(x+y)^2 - 2
	\] 
	L'integrale doppio rimanente si pu\`o nuovamente spezzare con Fubini:
	\[
	\begin{split}
		\int_{T} \left[ 4(x+y) - \frac{3}{2}(x+y)^2 - 2\right]  dxdy &= \int_{0} ^2 dx \int_{0} ^{2- x} \left[ 4(x+y) - \frac{3}{2}(x+y)^2 - 2\right] dy\\
									     &=\int_{0} ^2 \left[ 4xy + 2y^2 - \frac{3}{2}\left(x^2 y + xy^2  + \frac{1}{3}y^3\right) -2y \right] _{y=0} ^{y= x-2} dx \\
									     &=\int_{0} ^2 \left(\frac{1}{2}x^3 - 2 x^2 + 2x\right) dx = \left[ \frac{1}{8} x^4 - \frac{2}{3}x^3 + x^2\right] _0^2= \frac{2}{3}
	\end{split}
	\] 
	
\end{svolgimento}
\end{esempio}
\noindent L'eq. \ref{volintfub} si pu\`o usare nel calcolo di volumi degli insiemi normali. Dato 
\[
E := \left\{ (x,y,z) \in \mathbb{R}^3 : (x,y) \in F, \ g(x,y) \le z \le h(x,y) \right\} 
\] 
e posto $f=1$ in eq. \ref{volintfub}, si ha:
\begin{equation}\label{misfub}
	m(E) = \int_{F} \big[h(x,y) - g(x,y)\big] dxdy
\end{equation}
\begin{esempio}
Per $Q = (0,1) \times (0,1)$, calcolare il volume dell'insieme
\[
	E := \left\{ (x,y,z) \in \mathbb{R}^3 : (x,y) \in Q, \ x+y \le z \le  x^2 + y^2 + 1 \right\} 
\] 
\begin{svolgimento}
	Usando direttamente eq. \ref{misfub}, si ha:
	\[
		\begin{split}
			m(E) &= \int_{Q} (1+x^2 + y^2 - x - y) dxdy = \int_{0} ^1 dy \int_{0} ^1 (1+x^2 + y^2 -x - y) dx \\
			     &= \int_{0} ^1 \left(1+ \frac{1}{3}  + y^2 - \frac{1}{2} - y\right) dy = \frac{2}{3}
		\end{split}
	\] 
	
\end{svolgimento}
\end{esempio}
\subsection{Cambiamento di variabili}
Si inizia con il caso di $f(x,y)$ funzione di due variabili, integrabile e a supporto compatto.
Nell'ipotesi che valga il teorema di Fubini:
\[
\int f(x,y) \ dxdy = \int dx \int (x,y) \ dy
\] 
Si fissa $x$ nell'ultimo integrale e si cambia variabile con $y= \varphi (x,v)\Rightarrow dy = \varphi _v (x,v) dv $, da cui
\[
\int f(x,y) \ dxdy = \int dx \int f\big(x,\varphi (x,v)\big)\lvert \varphi _v(x,v) \rvert dv
\] 
Usando il teorema di Fubini due volte, si pu\`o scrivere l'ultimo integrale prima come integrale doppio e poi come integrale prima rispetto a $x$ e poi rispetto a $v$:
\[
\int f(x,y) \ dxdy = \int f\big(x,\varphi (x,v)\big) \lvert \varphi (x,v) \rvert  \ dxdv  = \int dv \int f\big(x,\varphi (x,v)\big)\lvert \varphi _v(x,v) \rvert  dx
\] 
Nell'ultimo integrale, si fissa $v$ e si cambia variabile con $x=x(u,v)\Rightarrow dx = x_u (u,v) du$:
\[
\int f(x,y) \ dxdy = \int dv \int f\Big(x(u,v) , \varphi \big(x(u,v), v\big)\Big) \left\lvert \varphi _v\big(x(u,v) , v\big) x_u(u,v)\right\rvert du
\] 
Infine, si prendono:
\[
\begin{cases}
	x = x(u,v)\\
	y=\varphi \big(x(u,v),v\big)=y(u,v)
\end{cases}\implies \begin{cases}
y_u(u,v) = \varphi _x\big(x(u,v),v\big) x_u(u,v)\\
y_v (u,v) = \varphi _x\big(x(u,v),v\big)x_v(u,v) + \varphi _v \big(x(u,v),v\big)
\end{cases} 
\] 
da cui
\[
	\begin{split}
		\varphi _v\big(x(u,v),v\big)x_u(u,v) &= \big[y_v(u,v) - \varphi_x \big(x(u,v),v\big) x_v(u,v)\big]x_u(u,v)\\
						     &=y_v(u,v) x_u(u,v) - y_u(u,v)x_v(u,v)
	\end{split}
\] 
Sostituendo nell'integrale, si ottiene:
\begin{equation}
	\int f(x,y) \ dxdy = \int f\big(x(u,v),y(u,v)\big) \lvert x_uy_v - x_vy_u \rvert dudv
\end{equation}
Questa si adatta agli integrali su insieme $E$, notando che questo corrisponde a integrare $f \varphi _E$:
\[
	\int_E f(x,y) \ dxdy = \int f\big(x(u,v),y(u,v)\big) \varphi _E \big(x(u,v) , y(u,v)\big)\lvert x_uy_v - x_vy_u \rvert dudv
\] 
Visto che $\varphi _E$ vale $1$ se $\big(x(u,v), y(u,v)\big) \in E$ e $0$ altrimenti, essa \`e la funzione caratteristica dell'insieme $F$, immagine inversa di $E$ attraverso la trasformazione $x=x(u,v) , \ y = y(u,v)$. 
Quindi:
\begin{equation}\label{varcambE}
	\int _E f(x,y) \ dxdy = \int_F f\big(x(u,v),y(u,v)\big) \lvert x_uy_v - x_vy_u \rvert dudv
\end{equation}
\subsubsection{Ammissibilit\`a del cambiamento di variabili}
Si vuole capire quando \`e possibile trovare $\varphi (x,v)$ tale che $y(u,v) = \varphi \big(x(u,v) , v\big)$. 
Questo \`e possibile quando $x=x(u,v)$ si pu\`o risolvere rispetto a $u$, quindi se esiste $u=\gamma(x,v)$.
L'equazione che occorre \`e $\varphi (x,v) = y\big(\gamma(x,v),v\big)$, infatti $\gamma\big(x(u,v) , v\big)= u\Rightarrow \varphi \big(x(u,v),v\big)=y(u,v)$.
L'equazione $x=x(u,v)$ si pu\`o risolvere se $\forall v, \ x(u,v)$, considerata come funzione della sola $u$, \`e monotona, cio\`e se $x_u(u,v) \neq 0, \ \forall u,v$.

L'altra ipotesi necessaria \`e $\varphi _v(x,v)\neq 0$ che, dovendo valere $x_u(u,v) \neq 0 $, equivale a richiedere $\varphi _v(x,v) x_u(u,v) \neq 0$, ossia $x_uy_v - x_v y_u \neq 0 $.

Complessivamente, il cambio di variabili \`e lecito se sono verificate
\begin{equation}
	\begin{cases}
		x_u \neq 0 \\
		x_uy_v - x_v y_u \neq 0 
	\end{cases}
\end{equation}
Visto che lo stesso risultato si sarebbe ottenuto iniziando col cambio di variabili $y = \psi (x,u)$, dovendo comunque valere $x_uy_v - x_v y_u \neq 0$, si pu\`o sostituire $x_u\neq 0 $ con $x_v \neq 0$. Per questo, \`e sufficiente che $x_u,x_v$ non si annullino contemporaneamente\footnote{Cio\`e negli stessi punti.} (altrimenti anche $x_uy_v - x_vy_u = 0$).

Siano, ora, $x_u, x_v$ continue in rettangolo chiuso $R\supset F$. 
Si pu\`o dividere $R$ in numero finito di rettangoli $R_1,\ldots, R_N$, in ognuno dei quali o $x_u$, o $x_v$ \`e diversa da $0$. 
Allora si riscrive la formula del cambio di variabili in $F_k = F \cap R_k$:
\[
\int_{E_k} f(x,y) \ dxdy = \int_{F_k}  f\big(x(u,v) , y(u,v)\big) \lvert x_u y_v - x_vy_u \rvert dudv
\] 
con $E_k$ immagine di $F_k$ tramite la trasformazione $x = x(u,v),\ y = y(u,v)$. Sommando su $k$:
\[
\sum_{k=1}^{N}\int_{E_k} f(x,y) \ dxdy = \int_{F}  f\big(x(u,v) , y(u,v)\big) \lvert x_u y_v - x_vy_u \rvert dudv
\] 
Se gli $E_k$ sono tutti disgiunti, ossia se il cambio di variabili \`e invertibile, la somma dell'integrale al primo membro diventa un integrale su $E$ e si riottiene l'eq. \ref{varcambE}.
Questa, quindi, risulta valida solo nell'ipotesi che l'applicazione $x=x(u,v), \ y=y(u,v)$ sia iniettiva e che $x_uy_v-x_vy_u \neq 0$ sempre. 
Allora vale il seguente.
\begin{teorema}
	{}{}
	Sia $f(x,y)$ integrabile in $E \subset \mathbb{R}^2$ e sia $x=x(u,v), \ y=y(u,v)$ un'applicazione biunivoca di classe $C^1$, con inversa che va da un rettangolo $R\subset \mathbb{R}^2$ a un insieme contenente $E$ e tale che $x_uy_v - x_vy_u \neq 0 $ in $R$. Allora, indicando con $F$ l'immagine inversa di $E$, l'equazione \ref{varcambE} \`e valida.
	
\end{teorema}
\subsubsection{Matrice Jacobiana}
Il ragionamento fatto per il caso di due variabili si generalizza a pi\`u variabili: se in $\int_{E} f(\mathbf{x} ) \ dx_1 \ldots dx_n$ si esegue la sostituzione $\mathbf{x} = \mathbf{x} (\mathbf{u} ) ,\ \mathbf{u} =(u_1,\ldots,u_n)$, la formula di cambio variabili diventa:
\begin{equation}
	\int_{E} f(\mathbf{x} )\ dx_1\ldots dx_n = \int_{F} f\big(\mathbf{x}(\mathbf{u} ) \big) \lvert \det J(\mathbf{u} ) \rvert\ du_1\ldots du_n
\end{equation}
dove $\det J(\mathbf{u} )$ \`e il determinante della \textit{matrice Jacobiana} della trasformazione, definita come:
\begin{equation}
	J(\mathbf{u} ) = \begin{pmatrix} \displaystyle \frac{\partial x_1(\mathbf{u} )}{\partial u_1} & \cdots &\displaystyle \frac{\partial x_1(\mathbf{u} )}{\partial u_n} \\ &&\\\displaystyle \frac{\partial x_2(\mathbf{u} )}{\partial u_1}& \cdots &\displaystyle \frac{\partial x_2(\mathbf{u} )}{\partial u_n}  \\ \vdots &\ddots & \vdots \\ \displaystyle \frac{\partial x_n(\mathbf{u} )}{\partial u_1} & \cdots &\displaystyle \frac{\partial x_n(\mathbf{u} )}{\partial u_n}\end{pmatrix} 
\end{equation}
\subsection{Integrali impropri}
Si distinguono i casi in cui il dominio di integrazione non \`e limitato e quelli in cui la funzione non \`e limitata nelle vicinanze di uno o pi\`u punti.

\subsubsection{Integrali in domini non limitati}
Si analizza prima il caso particolare di $f$ positiva. 
L'idea \`e di tagliare il dominio di integrazione con una sfera di raggio $r$, integrare sull'insieme risultante e far tendere, poi, $r\to +\infty$. Si ha la seguente definizione.
\begin{definizione}
	{}{}
	Sia $f(\mathbf{x} )$ una funzione definita in $E \subset \mathbb{R}^n$, con $f(\mathbf{x} ) \ge 0, \ \forall x \in E$.
	Si assume che per ogni intorno dell'origine (al variare di $r$) $ I_r = \left\{ \mathbf{x}  \in \mathbb{R}^n : \left\lVert \mathbf{x}  \right\rVert < r\right\} $, $f$ sia integrabile in $E \cap I_r$.

	Si dice che $f$ \`e integrabile in senso improprio su $E$ se
	\[
	\lim_{r \to +\infty} \int_{E\cap I_r} f(\mathbf{x} ) \ d\mathbf{x}  < +\infty
	\] 
	In tal caso, varr\`a:
	\begin{equation}
		\int_{E}  f(\mathbf{x} ) \ d\mathbf{x} =  \lim_{r \to +\infty} \int_{E\cap I_r} f(\mathbf{x} ) \ d\mathbf{x} 
	\end{equation}
\end{definizione}
\noindent Avendo assunto $f(\mathbf{x} )\ge 0$, la funzione $F(r) = \int_{E\cap I_r} f(\mathbf{x} ) \ d\mathbf{x} $ \`e crescente, quindi il limite esiste sempre ed \`e uguale all'estremo superiore:
\[
\lim_{r \to +\infty} \int_{E \cap I_r} f(\mathbf{x} ) \ d\mathbf{x} = \sup_{r > 0} \int_{E\cap I_r} f(\mathbf{x} ) \ d\mathbf{x} 
\] 
\begin{obs}
	Se si avesse $E$ limitato, da un certo $r_0$ in poi, si avr\`a $E \subset  I_r\Rightarrow E\cap I_r = E$, quindi l'integrale per $r\to +\infty$ coinciderebbe con l'usuale integrale su $E$.
\end{obs}
\noindent Eliminando la condizione $f(\mathbf{x} )\ge 0$, l'esistenza del limite non sarebbe pi\`u garantita, ma si potrebbe aggiungere alla condizione di integrabilit\`a, oltre alla richiesta di limite finito, l'esistenza stessa del limite.

Il problema risiede, per\`o, nel fatto che se invece di tagliaere il dominio di integrazione con delle sfere, si usassero dei cubi (per esempio), il limite potrebbe divergere con le sfere e convergere con i cubi, o convergere con entrambe, ma dare un risultato diverso. 
Questo non accade se $f$ \`e positiva. 
\begin{proof}
	Si considerano per esempio le sfere $I_r$ e i cubi $Q_t = \big\{ \mathbf{x} \in \mathbb{R}^n : \max \left\{ \lvert x_1 \rvert , \ldots, \lvert  x_n\rvert < t \right\}  \big\} $. 
	Ogni sfera \`e contenuta in un cubo (infatti si ha proprio $I_r \subset Q_r$) e, viceversa, ogni cubo $Q_h$ \`e contenuto in una sfera $I_s$, con $s= \sqrt{n} h$.

	Visto che l'integrando \`e positivo:
	\[
	\int_{I_r} f \ d\mathbf{x} \le \int_{Q_t} f \ d\mathbf{x} \le \lim_{t \to +\infty} \int_{Q_t} f \ d\mathbf{x} \hspace{.2cm} \text{ e } \hspace{.2cm}\int_{Q_h} f \ d\mathbf{x} \le \int_{I_s} f \ d\mathbf{x} \le \lim_{s \to +\infty} \int_{I_s} f \ d\mathbf{x} 
	\] 
Mandando $r\to+\infty$ nella prima e $h\to+\infty$ nella seconda:	
\[
\lim_{r \to +\infty} \int_{I_r} f \ d\mathbf{x} \le \lim_{t \to +\infty} \int_{Q_t} f \ d\mathbf{x} \hspace{.2cm} \text{ e } \hspace{.2cm} \lim_{h \to +\infty} \int_{Q_h} f \ d \mathbf{x} \le \lim_{s \to +\infty} \int_{I_s} f \ d\mathbf{x} 
\]
quindi i due limiti coincidono. 
\end{proof}
\subsubsection{Integrali di funzioni non limitate}
Similmente al caso precedente, per $f$ non limitata attorno all'origine (per esempio), si taglia il dominio di integrazione $E$ con una sfera $I_r$ e si calcola l'integrale su $E\setminus I_r$, per poi far tendere $r\to 0^+$.
\begin{definizione}
	{}{}
Sia $f(\mathbf{x} )$ definita su $E\subset \mathbb{R}^n$, con $f(\mathbf{x} ) \ge 0 , \ \forall \mathbf{x} \in E$. 
Sia $\mathbf{x} _0$ un punto di accumulazione per $E$ e che per ogni intorno $I_r$ di $\mathbf{x} _0$, la funzione $f$ sia integrabile in $E \setminus I_r$. 
Allora si dice che $f$ \`e integrabile in senso improprio su $E$ se il limite 
\[
\lim_{r \to 0^+} \int_{E\setminus I_r} f(\mathbf{x} ) \ d\mathbf{x}  = \sup_{r>0} \int_{E \setminus I_r} f(\mathbf{x} ) \ d\mathbf{x} 
\] 
\`e finito. In questo caso:
\begin{equation}
	\int_{E} f(\mathbf{x} ) \ d\mathbf{x}  = \lim_{r \to 0^+} \int_{E \setminus I_r}  f(\mathbf{x} ) \ d\mathbf{x} 
\end{equation}
\end{definizione}
\noindent Se $f(\mathbf{x} ) $ fosse di segno variabile, si possono considerare le due funzioni non negative
\[
\begin{split}
	&f^+(\mathbf{x} ) = \max\left\{ f(\mathbf{x} ) , 0 \right\} \\
	&f^-(\mathbf{x} ) = \max\left\{ -f(\mathbf{x} ) , 0 \right\} 
\end{split} \implies f^+ - f^- = f
\] 
Allora si dir\`a che $f$ \`e integrabile in senso improprio su $E$ se ambedue le funzioni $f^+, \ f^-$ lo sono e
\begin{equation}
	\int_{E} f(\mathbf{x} ) \ d\mathbf{x} = \int_{E} f^+(\mathbf{x} ) \ d\mathbf{x} - \int_{E} f^- (\mathbf{x} ) \ d\mathbf{x} 
\end{equation}
\begin{esempio}
Dato $E$ l'insieme esterno al cerchio di raggio $1$, calcolare 
\[
\int_{E}  \frac{dxdy}{(x^2 + y^2 )^\alpha }
\] 
\begin{svolgimento}
Se $r>1$, l'insieme $E \cap I_r$ \`e la corona circolare $C_r$ di raggi $1$ e $r$. 
In coordinate polari, per $\alpha \neq 1$:
\[
	\int_{C_r} \frac{dxdy}{(x^2+y^2)^\alpha } = \int_{1} ^r \frac{\rho \ d\rho }{\rho ^{2\alpha } } \int_{0} ^{2\pi} d\varphi = 2\pi  \int_{1} ^r \rho ^{1-2\alpha } \ d\rho = 2\pi \Eval{\frac{\rho ^{2-2\alpha } }{2-2\alpha }}{1}{r} = \frac{\pi}{1-\alpha }(r^{2-2\alpha } -1)
\] 
Se $\alpha =1$, ripetendo un calcolo analogo, si ottiene $2  \pi \log r$.
Mandando $r\to +\infty$, quest'ultimo diverge a $+\infty$, come anche quello precedente per $\alpha <1$.
Se, invece, $\alpha > 1$:
\[
\lim_{r \to +\infty} \int_{C_r} \frac{dxdy}{(x^2+y^2)^\alpha }=\frac{\pi}{\alpha -1}
\] 
\end{svolgimento}
\end{esempio}
\newpage
\section{Curve e superfici}
\subsection{Curve in $\mathbb{R}^n$}
\begin{definizione}
	{Curva e parametrizzazione}{}
	Una curva \`e un'applicazione $\gamma: [a,b] \to \mathbb{R}^n$. L'equazione parametrica della curva \`e un'equazione della forma $\mathbf{x}  = \gamma(t)$.
\end{definizione}
\begin{esempio}
L'equazione $x = \cos t , \ y = \sin t, \ 0\le t\le 2\pi$ \`e l'equazione parametrica in $\mathbb{R}^2$ della circonferenza di raggio $1$ e centro l'origine.
\end{esempio}
\noindent Si vede $t$ come variabile temporale, per cui $\gamma(t)$ \`e la posizione al tempo $t$ di un punto mobile nello spazio $\mathbb{R}^n$. 
Si fissano due istanti $t_0,t$; nel tempo $t-t_0$ che intercorre fra i due istanti, la velocit\`a media (vettoriale) del punto \`e data da $\frac{\gamma(t) - \gamma(t_0)}{t-t_0}$.
Facendo tendere $t\to t_0$, se le componenti della curva $\gamma_1(t) , \ldots, \gamma_n(t)$ sono derivabili in $t_0$, si ottiene la velocit\`a istantanea del punto in $t_0$:
\[
\mathbf{v} (t_0) \equiv \gamma'(t_0) = \lim_{t \to t_0} \frac{\gamma(t) - \gamma(t_0)}{t-t_0}
\] 
Se $\gamma'(t_0) \neq 0 $, la retta tangente alla curva nel punto $\gamma(t_{0})$ \`e $\mathbf{x} = \gamma(t_0) + \gamma'(t_0) ( t-t_0)$, infatti la relazione 
\[
\lim_{t \to t_0} \frac{\gamma(t) - \gamma(t_0) -\mathbf{v}(t-t_0)}{t-t_0} = 0 \iff \mathbf{v} = \gamma'(t_0)\neq 0
\] 
Quindi, perch\'e esista la retta tangente a $\gamma$, \`e necessario che la derivata esista e sia anche diversa da $0$, altrimenti la curva non avrebbe una direzione ben definita in tale punto.
Da qui la seguente definizione.
\begin{definizione}
	{Regolarit\`a di una curva}{}
	Una curva $\gamma:[a,b]  \to \mathbb{R}^n$ si dice \textit{regolare} se ha derivata continua, che non si annulla in nessun punto di $(a,b)$.

	La curva $\gamma$ si dice \textit{regolare a tratti} se \`e continua e si pu\`o dividere l'intervallo $[a.b]$ in un numero finito di intervalli, in ognuno dei quali $\gamma$ \`e regolare.
\end{definizione}
\begin{esempio}
	Sia $f(x) \in C^1\big([a,b]\big)$; la curva piana di equazioni $x(t) = t, \ y(t) = f(t)$ \`e regolare perch\'e il vettore velocit\`a $\big(1,f'(t)\big)$ ha prima componente sempre pari a $1$.

	Il suo sostegno coincide con il grafico della funzione $f$.
\end{esempio}

\noindent Supponendo che la curva sia di classe $C^1$ senza assumere che $\gamma'(t)$ sia diversa da zero, il suo sostegno pu\`o avere dei punti angolosi. 
Ad esempio, nel caso di 
\[
\begin{cases}
	x = t^3\\
	y = t^2
\end{cases}
\] 
si ha $\gamma'(t) = (3t^2 , 2t)$, che si annulla per $t= 0$.
Eliminando $t$ dalle precedenti equazioni, si verifica che il sostegno della curva ha, effettivamente, una cuspide nell'origine; infatti da $t=\sqrt[3]{x} $, si ottiene $y= x^{2  / 3} $, che ha una cuspide nell'origine.

\begin{obs}
	Un altro modo per convincersi della necessit\`a di richiedere $\gamma' \neq 0$ \`e dovuto al fatto che se un punto si muove con velocit\`a non-nulla, non pu\`o cambiare direzione della velocit\`a senza avere una discontinuit\`a nella velocit\`a stessa; se, invece, ad un certo istante avesse velocit\`a nulla, potrebbe riprendere il moto in direzione generica senza discontinuit\`a.
\end{obs}
Si considera una curva piana $\big(x(t) , y(t)\big)$; l'equazione della retta ad essa tangente nel punto $\big(x(t_0) , y(t_0)\big)$ \`e, quindi:
\[
\begin{split}
	& x = x(t_0) + x'(t_0) (t-t_0)\\
	& y= y(t_0) + y'(t_0) (t-t_0)
\end{split}
\] 
Se $y'(t_0)  \neq 0$\footnote{Altrimenti, si ricava $t-t_0$ dalla prima perch\'e deve essere $x'(t_0) \neq 0 $ altrimenti al curva non sarebbe regolare.}, si ricava 
\[
t-t_0 = \frac{y-y(t_0)}{y'(t_0)}
\] 
che sostituito nella prima, permette di concludere che
\begin{equation}
y'(t_0) \big(x-x(t_0)\big) = x'(t_0) \big(y-y(t_0)\big)
\end{equation}
\begin{esempio}
	Calcolare la retta tangente alla curva $\gamma$ di equazioni\footnote{Questa curva \`e detta cicloide ed \`e quella descritta da un punto su una circonferenza di raggio $1$ che rotola su una retta.}
\[
\begin{cases}
	x = t- \sin t\\
	y = 1- \cos t
\end{cases}
\] 
in $P = (\pi / 2 - 1 , 1)$.
\begin{svolgimento}
	Intanto si deve verificare che il punto $P$ si trovi sulla curva, cio\`e che corrisponda a qualche $t_0$.
	Sia $y(t_0) = 1- \cos t_0 \stackrel{!}{=} 1\iff t_0 = \pi/2 + k\pi$. 
	Da questa condizione, si ottiene
	\[
	x(t_0) = t_0 - \sin t_0 = \frac{\pi}{2} + k\pi - 1 \stackrel{!}{=} \frac{\pi}{2}-1 \iff k=0
	\] 
	Allora il punto si trova sulla curva in corrispondenza di $t_0 = \pi / 2$.
	Per finire, si ha $x'(t) = 1 - \cos t$ e $y'(t) = \sin t$, quindi $x'(t_0) = 1$ e $y'(t_0) = 1$. 
La retta tangente, allora, \`e:
\[
y = x - \frac{\pi}{2} + 2
\] 

\end{svolgimento}
\end{esempio}
\begin{definizione}
	{Curve equivalenti}{}
	Due curve regolari $\varphi :\left[ a,b \right] \to \mathbb{R}^n $ e $\gamma: \left[ c,d \right] \to \mathbb{R}^n$ si dicono equivalenti se esiste una funzione $p:\left[ a,b \right] \to \left[ c,d \right] $, di classe $C^1$, suriettiva e sempre diversa da $0$, tale che $\varphi (t) = \gamma(p(t))$.
\end{definizione}
\noindent Due curve equivalenti hanno, evidentemente, stesso sostegno.
Inoltre, se $p'>0$, allora $p(t)$ \`e crescente e, quindi, $p(c) = a, \ p(d) = b$; in questo caso, le curve hanno stesso verso, mentre se fosse $p'<0$, avrebbero verso opposto con estremi scambiati, cio\`e $p(c) = b, \ p(d) = a$.
\begin{definizione}
	{Versore tangente}{}
	Il versore tangente ad una curva regolare $\varphi $ \`e definito come
	\[
	\tau _\varphi (t) = \frac{\varphi '(t)}{\left\lVert \varphi '(t) \right\rVert }
	\] 
Questo ha stesso verso e direzione della velocit\`a della curva e ha lunghezza unitaria.	
\end{definizione}
\begin{teorema}
	{}{}
	Se due curve $\varphi , \gamma$ sono equivalenti e hanno lo stesso verso, allora i loro versori tangenti coincidono.
	\begin{proof}
		Si abbia, allora, $\varphi '(t) = \gamma'(p(t)) p'(t)$ e $\left\lVert \varphi '(t) \right\rVert = \left\lVert \gamma'(p(t)) \right\rVert p'(t)$, visto che, per assunzione, le curve hanno stesso verso (ossia $p' > 0$).

		La tesi \`e dimostrata per calcolo diretto:
		\[
		\tau _\varphi  (t) = \frac{\varphi '(t) }{\left\lVert \varphi '(t) \right\rVert } = \frac{\gamma'(p(t)) p'(t)}{\left\lVert \gamma'(p(t)) \right\rVert p'(t)}=\frac{\gamma'(p(t))}{\left\lVert \gamma'(p(t)) \right\rVert }\equiv \tau _\gamma(p(t))
		\] 
	\end{proof}
\end{teorema}
\subsection{Lunghezza di una curva}

\begin{definizione}
	{Lunghezza di una curva}{}
	Sia $\gamma(t), \ a\le t \le b$ una curva di classe $C^1$. La sua lunghezza \`e data da:
	\[
	L(\gamma) = \int_{a} ^b \left\lVert \gamma'(t) \right\rVert  \ dt
	\] 
\end{definizione}
	Si nota che 
	\[
	\Delta x \overset{\text{def}}{=} \int_{a} ^b \gamma'(t) \ dt \equiv \gamma(b) - \gamma(a)
	\] 
	non coincide sempre con la lunghezza della curva perch\'e questo rappresenta lo spostamento: se la curva avesse estremi coincidenti, questo integrale restituirebbe $0$. Quindi si ha il seguente.
	\begin{teorema}
		{}{}
La lunghezza di una curva \`e sempre maggiore o uguale della norma dello spostamento, cio\`e:
\[
L(\gamma) = \int_{a} ^b \left\lVert \gamma'(t) \right\rVert \ dt \ge \left\lVert \int_{a} ^b \gamma'(t) \ dt \right\rVert  \equiv \left\lVert \gamma(b) - \gamma(a) \right\rVert 
\] 
\begin{proof}
	Se lo spostamento \`e nullo, questo \`e automaticamente verificato. 
	Nel caso di $\Delta x \neq 0  $, allora, si ha, per generico vettore $\mathbf{u} $:
	\[
	\int_{a} ^b \gamma'(t) \ dt \cdot  \mathbf{u} = \int_{a} ^b \gamma'(t)\cdot  \mathbf{u} \ dt \le \int_{a } ^b \left\lVert \gamma'(t) \right\rVert \left\lVert \mathbf{u}  \right\rVert \ dt = \left\lVert \mathbf{u}  \right\rVert  L
	\] 
	con $\cdot $ prodotto scalare.
	Nel caso particolare di $\mathbf{u}  = \int_{a}^b \gamma'(t) \ dt $, si ha:
	\[
	\left\lVert \int_{a} ^b \gamma'(t) \ dt  \right\rVert ^2 \le \left\lVert \int_{a} ^b \gamma'(t) \ dt \right\rVert  L 
	\] 
da cui segue la tesi.	
\end{proof}
	\end{teorema}
Sia $\gamma$ il segmento che unisce due punti $\mathbf{x}_1 , \mathbf{x} _2$; questo ha equazione parametrica $\mathbf{x}  = \mathbf{x} _1 + t (\mathbf{x} _2 - \mathbf{x} _1) , \ 0\le  t \le 1$. Allora $\gamma'(t) = \mathbf{x} _2 - \mathbf{x} _1$, pertanto:
\[
L(\gamma) = \int_{0} ^1 \left\lVert \gamma'(t) \right\rVert \ dt = \left\lVert \mathbf{x}_2 - \mathbf{x} _1  \right\rVert 
\] 
Allora la lunghezza di un segmento che unisce due punti \`e uguale alla distanza tra i punti stessi.

\begin{esempio}
Si considera nuovamente la curva di equazioni 
\[
\begin{cases}
	x = t^3\\
	y = t^2
\end{cases}
\] 
Calcolare la lunghezza di tale curva per $0\le t\le a$, con $a > 0$.
\begin{svolgimento}
	Per calcolo diretto, si ha:
	\[
	L = \int_{0} ^a \sqrt{9t^4 + 4t^2} \ dt = \int_{0} ^a t\sqrt{9t^2 + 4} \ dt
	\] 
	Per $u = t^2$, si ottiene:
	\[
		L = \frac{1}{2} \int_{0} ^{a^2} \sqrt{9u + 4 }  \ du = \Eval{\frac{1}{27}(9u + 4)^{3 / 2} }{0}{a^2} = \frac{1}{27} \left[ \left(9a^2  + 4 \right) ^{3 / 2}  - 8 \right] 
	\] 
\end{svolgimento}
\end{esempio}
	Sia data la curva in coordinate polari
	\[
		\begin{cases}
	\rho  = \rho (t)\\
	\varphi = \varphi (t)
		\end{cases}, \ a\le t \le b
	\] 
corrispondente alle equazioni parametriche
\[
\begin{cases}
	 x = \rho (t) \cos \varphi (t) \\
	 y = \rho  (t) \sin \varphi (t)
\end{cases}, \ a \le t \le b
\] 
Allora 
\[
\begin{cases}
	x' (t) = \rho '(t) \cos \varphi (t) - \rho (t) \varphi '(t)\sin \varphi (t) \\
	y'(t) = \rho '(t) \sin \varphi (t) + \rho (t) \varphi '(t) \cos \varphi (t)
\end{cases} \Rightarrow x'^2 (t) + y'^2(t) = \rho '^2(t) + \rho ^2 (t) \varphi '^2(t)
\] 
La lunghezza della curva sar\`a, allora, data da:
\begin{equation}
	L = \int_{a} ^b \sqrt{\rho '^2(t) + \rho ^2 (t) \varphi '^2(t)} \ dt
\end{equation}
Talvolta, si prende come $t$ lo stesso angolo $\varphi $; in questo caso si ha $\rho  = \rho (\varphi ) , \ \varphi _0 \le  \varphi  \le \varphi _1$, quindi l'equazione diventa
\begin{equation}
	L = \int_{\varphi _0} ^{\varphi _1} \sqrt{\rho '^2(\varphi ) + \rho ^2 (\varphi )}  \ d\varphi 
\end{equation}
essendo $\varphi ' = 1$.
\begin{esempio}
Si considera un \textit{cardioide}, di equazione $\rho  = (1+ \cos\varphi ) , \ 0\le \varphi \le  2\pi $. Calcolarne la lunghezza.
\begin{svolgimento}
	Si ha 
	\[
	L = \int_{0} ^{2\pi} \sqrt{\sin^2 \varphi  + (1+ \cos\varphi )^2 }  \ d\varphi  = \int_{0} ^{2\pi} \sqrt{2 + 2 \cos \varphi  }  \ d\varphi = 2 \int_{0} ^{2\pi}\left\lvert \cos \frac{\varphi }{2}  \right\rvert   \ d\varphi 
	\] 
	Prendendo $2 u = \varphi $:
	\[
	L = 4 \int_{0} ^\pi \lvert \cos u \rvert  \ du = 8 \int_{0} ^{\pi / 2} \cos u \ du = 8 
	\] 
\end{svolgimento}
\end{esempio}
\begin{teorema}
	{Lunghezza di curve equivalenti}{}
	Due curve equivalenti $\sigma , \gamma$ hanno stessa lunghezza.
	\begin{proof}
		Sia $\sigma (t) = \gamma(p(t))$, con $p'(t) \neq 0 $. 
		Si assume, senza perdita di generalit\`a, $p'>0$, quindi $\left\lVert \sigma '(t) \right\rVert = \left\lVert \gamma'(p(t)) \right\rVert p'(t)$, pertanto:
\[
L (\sigma ) = \int_{c} ^d \left\lVert \sigma '(t) \right\rVert \ dt = \int_{c} ^d \left\lVert \gamma '(p(t)) \right\rVert p'(t) \ dt 
\] 
Cambiando variabili con $ u = p(t)$ e usando che $p'>0$, per cui si ha $p(c) = a , \ p(d)= b  $, si ha:
\[
L(\sigma ) = \int_{c} ^d \left\lVert \gamma'(p(t))  \right\rVert p'(t) \ dt = \int_{a} ^b \left\lVert \gamma' (u)\right\rVert  \ du \equiv L(\gamma)
\] 
Se, invece, fosse $p'<0$, si avrebbe un segno $-$ dovuto a $p'$, ma gli estremi di integrazione verrebbero invertiti, quindi il risultato \`e consistente:
\[
	L(\sigma ) = - \int_{c} ^d \left\lVert \gamma'(p(t)) \right\rVert p'(t) \ dt = \int_{b} ^a \left\lVert \gamma'(u)  \right\rVert  \ du \equiv L(\gamma)
\] 
	\end{proof}
\end{teorema}
Inscrivendo in una circonferenza un poligono regolare, il perimetro dell'ultimo \`e sempre minore della lunghezza della circonferenza e la approssima tanto meglio, quanto pi\`u aumenta il numero di lati. 
Di fatto, la lunghezza della circonferenza si definisce come il limite dei perimetri dei poligono regolari inscritti.

Usando questo ragionamento, si ottiene la lunghezza di una curva approssimandola con delle spezzate con vertici sul suo sostegno.

Sia $\gamma : \left[ a,b \right] \to \mathbb{R}^n$ una curva di classe $C^1$. 
Si divide $\left[ a,b \right] $ in $N$ sottintervalli con estremi $a= t_0 < t_1< \ldots< t_N = b$;
unendo i corrispondenti $\gamma(t_0), \gamma(t_1), \ldots, \gamma(t_N)$, si ottiene una spezzata $\Sigma$, i cui vertici sono sul sostegno della curva $\gamma$.

La lunghezza di $\Sigma$ sar\`a, evidentemente, minore della lunghezza della curva perch\'e, per quanto visto:
\[
	\begin{split}
		&\left\lVert \gamma(t_i) - \gamma(t_{i-1} ) \right\rVert  = \left\lVert \int_{t_{i-1} } ^{t_i} \gamma'(t) \ dt  \right\rVert \le  \int_{t_{i-1} } ^{t_i} \left\lVert \gamma'(t) \right\rVert \  dt\\
		&\Rightarrow L(\Sigma) = \sum_{i=1}^{N} \left\lVert \gamma(t_i) - \gamma(t_{i-1} ) \right\rVert \le \sum_{i=1}^{N} \int_{t_{i-1} } ^{t_i} \left\lVert \gamma'(t) \right\rVert \ dt = \int_{a} ^b \left\lVert \gamma'(t) \right\rVert \ dt 
	\end{split}
\] 
Tuttavia, prendendo $t_i$ molto vicini fra loro, si pu\`o far avvicinare $L(\Sigma)$ a $L(\gamma)$ a piacimento.
Per dimostrare questo, occorre il seguente lemma.
\begin{lemma}
	{}{lemcurv}
	Sia $\mathbf{v} (t):\left[ \alpha ,\beta  \right] \to \mathbb{R}^n$ e sia $\tau \in \left[ \alpha ,\beta  \right] $; allora si ha:
	\[
	\left\lVert \int_{\alpha } ^{\beta } \mathbf{v} (t)  \ dt\right\rVert \ge \int_{\alpha } ^\beta  \left\lVert \mathbf{v} (t)  \right\rVert  \ dt   - 2 \int_{\alpha } ^\beta \left\lVert \mathbf{v} (t) - \mathbf{v} (\tau ) \right\rVert  \ dt 
	\] 
\begin{proof}
	Si ha:
	\[
	\mathbf{v} (\tau ) (\beta -\alpha ) = \int_{\alpha } ^{\beta } \mathbf{v} (\tau ) \ dt = \int_{\alpha } ^\beta \mathbf{v} (t) \ dt - \int_{\alpha } ^\beta \big[ \mathbf{v} (t) - \mathbf{v} (\tau ) \big]  \ dt 
	\] 
Usando la disuguaglianza triangolare:
\[
	\left\lVert \mathbf{v} (\tau ) \right\rVert (\beta - \alpha ) \le \left\lVert \int_{\alpha } ^\beta \mathbf{v} (t) \ dt  \right\rVert  + \left\lVert \int_{\alpha } ^\beta \big[\mathbf{v} (t) - \mathbf{v} (\tau )\big] \ dt \right\rVert \le \left\lVert \int_{\alpha } ^\beta \mathbf{v} (t) \ dt \right\rVert + \int_{\alpha } ^\beta \left\lVert \mathbf{v} (t) - \mathbf{v}(\tau )  \right\rVert \ dt 
\] 
Sempre per la disuguaglianza triangolare, risulta $\left\lVert \mathbf{v} (\tau ) \right\rVert \ge \left\lVert \mathbf{v} (t) \right\rVert - \left\lVert \mathbf{v} (t)  - \mathbf{v} (\tau ) \right\rVert  $, quindi, integrando:
\[
\left\lVert \mathbf{v} (\tau ) \right\rVert (\beta -\alpha ) \ge \int_{\alpha } ^\beta \left\lVert \mathbf{v} (t) \right\rVert \ dt - \int_{\alpha } ^\beta \left\lVert \mathbf{v} (t) - \mathbf{v} (\tau ) \right\rVert  \ dt 
\] 
Confrontando le due disuguaglianze ottenute, si ottiene direttamente la tesi.
\end{proof}	
\end{lemma}
\begin{teorema}
	{}{}
	La lunghezza di una curva regolare $\gamma$ \`e l'estremo superiore delle lunghezze delle spezzate con i vertici sul suo sostegno.
	\begin{proof}
		La funzione $\gamma'$ \`e continua in $\left[ a,b \right] $, quindi \`e uniformemente continua nello stesso.
		Fissato, dunque, $\varepsilon >0, \ \exists \delta >0 $ tale che se $t, \tau \in \left[ a,b \right] $, allora $\lvert t-\tau  \rvert <\delta \Rightarrow \left\lVert \gamma'(t) - \gamma'(\tau )   \right\rVert < \varepsilon $.

		Si divide $\left[ a,b \right] $ in intervalli pi\`u piccoli, con estremi $a = t_0 < t_1 < \ldots < t_N = b$ in modo tale che ogni $\left[ t_{i-1} ,t_i \right] $ abbia lunghezza $\lvert t_i - t_{i-1}  \rvert < \delta $.

		Per il lemma \ref{lem:lemcurv}, si ha:
		\[
		\left\lVert \gamma(t_i) - \gamma(t_{i-1} ) \right\rVert  = \left\lVert \int_{t_{i-1} } ^{t_i} \gamma'(t) \ dt  \right\rVert \ge  \int_{t_{i-1} } ^{t_i} \left\lVert \gamma'(t) \right\rVert  \ dt - 2 \int_{t_{i-1} } ^{t_i} \left\lVert \gamma'(t) - \gamma'(\tau ) \right\rVert \ dt
		\] 
		con $\tau $ punto generico in $\left[ a,b \right] $.
		Per costruzione, risulta $\left\lVert \gamma'(t) - \gamma'( \tau ) \right\rVert < \varepsilon $, pertanto
		\[
		\left\lVert \gamma(t_i) - \gamma(t_{i-1})  \right\rVert \ge  \int_{t_{i-1} } ^{t_i} \left\lVert \gamma' (t) \right\rVert \ dt - 2 \varepsilon  ( t_i - t_{i-1} )
		\] 
	Sommando su $i= 1, \ldots, N$ al primo membro, si ottiene la lunghezza della spezzata.
	Al secondo membro, la somma degli integrali restituisce la lunghezza della curva, mentre quella dell'altro termine restituisce $2\varepsilon  (b-a)$. 
	In conclusione, si \`e trovato
	\[
	L(\Sigma) \ge  \int_{a} ^b \left\lVert \gamma'  (t)\right\rVert \ dt - 2\varepsilon (b-a)
	\] 
	Conseguentemente, anche l'estremo superiore delle lunghezze delle spezzate \`e maggiore della stessa quantit\`a; per l'arbitrariet\`a di $\varepsilon $, tale $\sup$ \`e maggiore o uguale alla lunghezza della curva. 

	Avendo gi\`a mostrato la disuguaglianza opposta, segue l'uguaglianza e, al contempo, anche la tesi.
	\end{proof}
\end{teorema}
Si definisce la lunghezza di una porzione di curva $\gamma$ nell'estremo $\left[ a,t \right] $ come
\[
s(t) = \int_{a} ^t \left\lVert \gamma'(r) \right\rVert \ dr
\] 
Al variare di $t \in \left[ a,b \right] $, $s(t)$ varia in $\left[ 0,L \right] $; se $\gamma$ \`e regolare, allora $s(t)$ \`e strettamente crescente, visto che $ s'(t) = \left\lVert \gamma'(t) \right\rVert > 0$.

Sia, allora, $t(s) $ la sua inversa, che mappa $\left[ 0, L \right] \to \left[ a,b \right] $ e 
\[
	t'(s) = \Eval{\frac{1}{s'(t)}}{t = t(s)}{}  = \frac{1}{\left\lVert \gamma'(t(s)) \right\rVert }
\] 
Ponendo $\psi (s) = \gamma(t(s))$, la curva $\psi $ \`e equivalente a $\gamma$ e ha stesso verso; inoltre
\[
\psi' (s) = \gamma'(t(s)) t'(s) = \frac{\gamma'(t(s))}{\left\lVert \gamma'(t(s)) \right\rVert }
\] 
cio\`e $\left\lVert \psi '(s) \right\rVert = 1$ e la velocit\`a coincide col versore tangente.

	Nel caso in cui $\gamma$ \`e il grafico di una funzione $y(x)$, si ha $s'(x) = \sqrt{1 + y'^2 (x)} $; la qantit\`a $s$ \`e detta \textbf{ascissa curvilinea}. 
	In casi del genere, la lunghezza della curva coincide con l'integrale $\int_{\psi }  ds$.

	In generale, la notazione $\int_{\gamma} ds$ si pu\`o usare per indicare la lunghezza di una generica curva $\gamma$, essendo $ds = \left\lVert \gamma'(t) \right\rVert dt $.
	Tale notazione \`e dovuta al fatto che la lunghezza del segmento infinitesimo tra i punti $\gamma(t)$ e $\gamma(t+dt)$ \`e
	\[
	ds = \left\lVert \gamma(t+dt) - \gamma(t) \right\rVert = \left\lVert d\gamma(t) \right\rVert  = \left\lVert \gamma'(t) \right\rVert  dt 
	\] 
In questo modo, si pu\`o dare la definizione di \textbf{integrale curvilineo} di una funzione $f$.
\begin{definizione}
	{Integrale curvilineo}{}
	Sia $f$	una funzione; il suo integrale curvilineo \`e definito come:
	\[
	\int_{\gamma} f \ ds = \int_{a} ^b f(\gamma(t)) \left\lVert \gamma' (t)\right\rVert \ dt 
	\] 
\end{definizione}
Se, poi, $\gamma$ e $\sigma $ sono due curve equivalenti, l'integrale curvilineo di $f$ su $\sigma $ coincide con quello su $\gamma$:
\begin{equation}
	\int_{\gamma}  f \ ds = \int_{\sigma } f \ ds
\end{equation}
\begin{proof}
	Sia $\sigma (t) = \gamma(p(t))$. Per conto diretto, assumendo senza perdita di generalit\`a che $p' > 0$:
	\[
		\begin{split}
			\int_{\sigma } f \ ds &= \int_{c} ^d f(\sigma (t)) \left\lVert \sigma '(t) \right\rVert  \ dt = \int_{c} ^d f\big(\gamma(p(t))\big)\left\lVert \gamma'(p(t)) \right\rVert p'(t) \ dt\\
					      &= \int_{a} ^b f(\gamma(r)) \left\lVert \gamma'(r) \right\rVert  \ dr \equiv \int_{\gamma} f \ ds
		\end{split}
	\] 
dove si \`e preso $r = p(t)\Rightarrow dr = p'(t) \ dt $. 
Se fosse $p'<0$, si otterrebbe lo stesso risultato.
\end{proof}
\begin{esempio}
Calcolare, per $\gamma$ arco di parabola di equazioni $x = t  , \ y = t^2, \ 0\le t \le  1$, l'integrale
\[
\int_{\gamma}  \sqrt{1 + 3x^2 +y }  \ ds
\] 
\begin{svolgimento}
	Si ha $ds = \sqrt{1 + 4t^2}  dt  $, quindi:
	\[
	\int_{\gamma} \sqrt{1+ 3x^2 + y}  \ ds = \int_{0} ^1 (1+4t^2) \ dt = \frac{7}{3}
	\] 
	
\end{svolgimento}
\end{esempio}















\end{document} 
